import{_ as r,T as c,z as p,A as n,I as s,O as a,V as t,X as o,D as i}from"./plugin-vue_export-helper.1b30df3c.js";const Bn='{"title":"@fxjs/db-driver","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u652F\u6301\u7684\u6570\u636E\u5E93\u7C7B\u578B","slug":"\u652F\u6301\u7684\u6570\u636E\u5E93\u7C7B\u578B"},{"level":2,"title":"\u5FEB\u901F\u5F00\u59CB","slug":"\u5FEB\u901F\u5F00\u59CB"},{"level":2,"title":"Driver","slug":"driver"},{"level":3,"title":"Driver.create(connection: string | object): DriverInstance","slug":"driver-create-connection-string-object-driverinstance-static"},{"level":3,"title":"Driver.formatUrl(urlObj: object): string","slug":"driver-formaturl-urlobj-object-string-static"},{"level":3,"title":"Driver.getDriver(type: string): DriverConstructor","slug":"driver-getdriver-type-string-driverconstructor-static"},{"level":3,"title":"Driver::uid","slug":"driver-uid-readonly"},{"level":3,"title":"Driver::uri","slug":"driver-uri-readonly"},{"level":3,"title":"Driver::type","slug":"driver-type"},{"level":3,"title":"Driver::config","slug":"driver-config-readonly"},{"level":3,"title":"Driver::extend_config","slug":"driver-extend-config-readonly"},{"level":3,"title":"Driver::connection","slug":"driver-connection-readonly"},{"level":3,"title":"Driver::isPool","slug":"driver-ispool-readonly"},{"level":3,"title":"Driver::isSql","slug":"driver-issql-readonly"},{"level":3,"title":"Driver::isNoSql","slug":"driver-isnosql-readonly"},{"level":3,"title":"Driver::isCommand","slug":"driver-iscommand-readonly"},{"level":3,"title":"Driver::open(): void","slug":"driver-open-void"},{"level":3,"title":"Driver::close(): void","slug":"driver-close-void"},{"level":3,"title":"Driver::reopen(): void","slug":"driver-reopen-void"},{"level":3,"title":"Driver::getConnection(): T","slug":"driver-getconnection-t"},{"level":3,"title":"Driver::connectionPool(callback: (connection: CONN_TYPE) => any): any","slug":"driver-connectionpool-callback-connection-conn-type-any-any"},{"level":3,"title":"Driver::useTrans(callback: (conn_for_trans: CONN_TYPE) => any)","slug":"driver-usetrans-callback-conn-for-trans-conn-type-any"},{"level":2,"title":"SQLDriver","slug":"sqldriver"},{"level":3,"title":"SQLDriver::switchDb(db: name)","slug":"sqldriver-switchdb-db-name"},{"level":3,"title":"SQLDriver::trans(cb: Function): boolean","slug":"sqldriver-trans-cb-function-boolean"},{"level":3,"title":"SQLDriver::execute(sql: string)","slug":"sqldriver-execute-sql-string-blocking"},{"level":2,"title":"RedisDriver","slug":"redisdriver"},{"level":3,"title":"RedisDriver::command(cmd: string, arg: any)","slug":"redisdriver-command-cmd-string-arg-any-blocking"},{"level":3,"title":"`RedisDriver::commands(cmds: Record","slug":"redisdriver-commands-cmds-record-string-any-opts-object-blocking"},{"level":2,"title":"MongoDriver","slug":"mongodriver"},{"level":3,"title":"MongoDriver::command(cmd: string, arg: any)","slug":"mongodriver-command-cmd-string-arg-any-blocking"},{"level":3,"title":"MongoDriver::commands(cmds: object, opts: object)","slug":"mongodriver-commands-cmds-object-opts-object-blocking"}],"relativePath":"orm-packages/db-driver.md","lastUpdated":1699867082773}',d={},l=o(`<h1 id="fxjs-db-driver" tabindex="-1"><code>@fxjs/db-driver</code> <a class="header-anchor" href="#fxjs-db-driver" aria-hidden="true">#</a></h1><p><a href="https://www.npmjs.org/package/@fxjs/db-driver" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/v/@fxjs/db-driver.svg" alt="NPM version"></a>\xA0 <a href="https://www.npmjs.org/package/@fxjs/db-driver" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/dt/@fxjs/db-driver.svg" alt="NPM download"></a>\xA0 <a href="https://www.npmjs.org/package/@fxjs/db-driver" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/dm/@fxjs/db-driver.svg" alt="NPM download monthly"></a></p><p>db-driver \u63D0\u4F9B\u4E86\u7EDF\u4E00\u7684\u63A5\u53E3 <code>Driver</code>, \u7528\u4E8E\u64CD\u4F5C\u6570\u636E\u5E93.</p><h2 id="\u652F\u6301\u7684\u6570\u636E\u5E93\u7C7B\u578B" tabindex="-1">\u652F\u6301\u7684\u6570\u636E\u5E93\u7C7B\u578B <a class="header-anchor" href="#\u652F\u6301\u7684\u6570\u636E\u5E93\u7C7B\u578B" aria-hidden="true">#</a></h2><p>\u76EE\u524D db-driver \u652F\u6301\u7684\u6570\u636E\u5E93\u7C7B\u578B\u6709:</p><table><thead><tr><th>\u6570\u636E\u5E93</th><th>\u9A71\u52A8\u7C7B\u578B\u6807\u8BC6</th><th>Driver \u7C7B\u578B</th></tr></thead><tbody><tr><td>MySQL/MariaDB</td><td><code>mysql</code></td><td><code>SQLDriver</code> <code>MySQLDriver</code></td></tr><tr><td>PostgreSQL</td><td><code>postgresql</code></td><td><code>PostgreSQLDriver</code></td></tr><tr><td>SQLite</td><td><code>sqlite</code></td><td><code>SQLiteDriver</code></td></tr><tr><td>Redis</td><td><code>redis</code></td><td><code>RedisDriver</code></td></tr><tr><td>MongoDB</td><td><code>mongodb</code></td><td><code>MongoDBDriver</code></td></tr></tbody></table><h2 id="\u5FEB\u901F\u5F00\u59CB" tabindex="-1">\u5FEB\u901F\u5F00\u59CB <a class="header-anchor" href="#\u5FEB\u901F\u5F00\u59CB" aria-hidden="true">#</a></h2><p>\u5B89\u88C5</p><div class="language-sh"><pre><code><span class="token function">npm</span> <span class="token function">install</span> @fxjs/db-driver
</code></pre></div><p>\u5728 fibjs \u4E2D\u6784\u9020\u4E00\u4E2A\u9002\u7528\u4E8E <code>mysql</code> \u7684 dbdriver</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Driver <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;@fxjs/db-driver&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// use connection string</span>
<span class="token keyword">var</span> driver <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:password@localhost:3306/mydb&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or use connection object</span>
<span class="token keyword">var</span> driver <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">protocol</span><span class="token operator">:</span> <span class="token string">&#39;mysql:&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hostname</span><span class="token operator">:</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;root&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
    <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;password&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">&#39;mydb&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// open connection</span>
driver<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// execute sql query</span>
driver<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&#39;CREATE DATABASE IF NOT EXISTS mydb&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// close connection</span>
driver<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// reopen connection, equivalent to \`driver.close()\` safely and then \`driver.open()\`</span>
driver<span class="token punctuation">.</span><span class="token function">reopen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="driver" tabindex="-1"><code>Driver</code> <a class="header-anchor" href="#driver" aria-hidden="true">#</a></h2>`,12),u={id:"driver-create-connection-string-object-driverinstance-static",tabindex:"-1"},v=n("code",null,"Driver.create(connection: string | object): DriverInstance",-1),k=n("a",{class:"header-anchor",href:"#driver-create-connection-string-object-driverinstance-static","aria-hidden":"true"},"#",-1),_=o(`<p>\u6839\u636E\u4F20\u5165\u6570\u636E\u5E93\u8FDE\u63A5\u5B57\u7B26\u4E32, \u6216\u8005\u6570\u636E\u5E93\u8FDE\u63A5\u5BF9\u8C61, \u521B\u5EFA\u4E00\u4E2A <code>Driver</code> \u5B9E\u4F8B. Driver \u4F1A\u6839\u636E\u4F20\u9012\u7684\u524D\u7F00, \u81EA\u52A8\u9009\u62E9\u5BF9\u5E94\u7684\u6570\u636E\u5E93\u7C7B\u578B.</p><div class="language-js"><pre><code><span class="token keyword">var</span> mydb <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> pgdb <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;psql://root:@localhost:5432&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> pgdb <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;postgresql://root:@localhost:5432&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> pgdb <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;pg://root:@localhost:5432&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> redisCmder <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;redis://127.0.0.1:6379&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> sqliteDB <span class="token operator">=</span>Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;sqlite:web.db&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sqliteDB <span class="token operator">=</span>Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;sqlite:/var/www/web.db&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>`,2),h={id:"driver-formaturl-urlobj-object-string-static",tabindex:"-1"},g=n("code",null,"Driver.formatUrl(urlObj: object): string",-1),m=n("a",{class:"header-anchor",href:"#driver-formaturl-urlobj-object-string-static","aria-hidden":"true"},"#",-1),b=o(`<p>\u5C06\u4E00\u4E2A\u5BF9\u8C61\u683C\u5F0F\u5316\u4E3A\u6570\u636E\u5E93\u8FDE\u63A5\u5B57\u7B26\u4E32.</p><div class="language-js"><pre><code>Driver<span class="token punctuation">.</span><span class="token function">formatURL</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">protocol</span> <span class="token operator">:</span> <span class="token string">&quot;mysql:&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hostname</span> <span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">username</span> <span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">port</span>     <span class="token operator">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
    <span class="token literal-property property">password</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pathname</span> <span class="token operator">:</span> <span class="token string">&quot;/mydb&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">slashes</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// use \`//\` after protocol</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// =&gt; &quot;mysql://root@localhost:3306/mydb&quot;</span>

Driver<span class="token punctuation">.</span><span class="token function">formatURL</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">protocol</span><span class="token operator">:</span> <span class="token string">&quot;sqlite:&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">&#39;web.db&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// =&gt; &quot;sqlite:web.db&quot;</span>
</code></pre></div>`,2),y={id:"driver-getdriver-type-string-driverconstructor-static",tabindex:"-1"},D=n("code",null,"Driver.getDriver(type: string): DriverConstructor",-1),f=n("a",{class:"header-anchor",href:"#driver-getdriver-type-string-driverconstructor-static","aria-hidden":"true"},"#",-1),q=o(`<p>\u6839\u636E\u4F20\u5165 <code>type</code> \u83B7\u53D6\u5BF9\u5E94\u7684 driver. <code>type</code> \u53EF\u4EE5\u662F\u51C6\u786E\u7684\u9A71\u52A8\u7C7B\u578B <code>&#39;mysql&#39; | &#39;sqlite&#39; | &#39;psql&#39; | &#39;mssql&#39; | &#39;redis&#39; | &#39;mongodb&#39;</code></p><div class="language-js"><pre><code><span class="token comment">// return mysql driver</span>
Driver<span class="token punctuation">.</span><span class="token function">getDriver</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u4E5F\u53EF\u4EE5\u662F\u5E26\u6709\u5408\u6CD5 protocol \u524D\u7F00\u7684\u5B57\u7B26\u4E32, \u6BD4\u5982\u8FDE\u63A5\u5B57\u7B26\u4E32. \u5F53\u53D1\u73B0\u4F20\u5165\u5B57\u7B26\u4E32\u4E0D\u662F\u51C6\u786E\u7684\u9A71\u52A8\u7C7B\u578B\u65F6, \u4F1A\u5C1D\u8BD5\u5C06\u5176\u6309 url \u89E3\u6790, \u83B7\u5F97\u5176 protocol \u5E76\u4EE5\u6B64\u53D6\u5F97\u5BF9\u5E94\u7684\u9A71\u52A8\u7C7B\u578B.</p><div class="language-js"><pre><code><span class="token comment">// return mysql driver</span>
Driver<span class="token punctuation">.</span><span class="token function">getDriver</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://localhost:3306/mydb&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// return sqlite driver</span>
Driver<span class="token punctuation">.</span><span class="token function">getDriver</span><span class="token punctuation">(</span><span class="token string">&#39;sqlite:web.db&#39;</span><span class="token punctuation">)</span>
</code></pre></div>`,4),S={id:"driver-uid-readonly",tabindex:"-1"},T=n("code",null,"Driver::uid",-1),x=n("a",{class:"header-anchor",href:"#driver-uid-readonly","aria-hidden":"true"},"#",-1),w=n("p",null,"Driver \u5B9E\u4F8B\u521B\u5EFA\u65F6, \u751F\u6210\u7684\u552F\u4E00 id. \u4E0D\u53EF\u66F4\u6539, \u4E00\u822C\u7528\u4E8E\u5F00\u53D1\u8005\u5185\u90E8 debug",-1),j={id:"driver-uri-readonly",tabindex:"-1"},C=n("code",null,"Driver::uri",-1),A=n("a",{class:"header-anchor",href:"#driver-uri-readonly","aria-hidden":"true"},"#",-1),L=n("p",null,"\u5F53\u524D Driver \u7ECF\u8FC7\u683C\u5F0F\u5316\u7684\u8FDE\u63A5 uri.",-1),P=n("p",null,[n("strong",null,"\u6CE8\u610F"),s(" \u683C\u5F0F\u5316\u540E\u7684 uri \u66F4\u89C4\u8303, \u4E0D\u4E00\u5B9A\u7B49\u4E8E\u4F20\u5165\u7684 uri.")],-1),Q=n("h3",{id:"driver-type",tabindex:"-1"},[n("code",null,"Driver::type"),s(),n("a",{class:"header-anchor",href:"#driver-type","aria-hidden":"true"},"#")],-1),E=n("p",null,[s("\u5F53\u524D Driver \u7684\u9A71\u52A8\u7C7B\u578B, \u53C2\u8003"),n("a",{href:"#%E6%94%AF%E6%8C%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"},"\u9A71\u52A8\u7C7B\u578B\u6807\u8BC6")],-1),N={id:"driver-config-readonly",tabindex:"-1"},I=n("code",null,"Driver::config",-1),R=n("a",{class:"header-anchor",href:"#driver-config-readonly","aria-hidden":"true"},"#",-1),V=n("p",null,[s("\u5F53\u524D Driver \u7684\u914D\u7F6E, \u8BE5\u914D\u7F6E\u662F\u5BF9 "),n("code",null,"new Driver(options)"),s(" \u4E2D "),n("code",null,"options"),s(" \u89E3\u6790\u540E\u7684\u5BF9\u8C61\u7684"),n("strong",null,"\u5FEB\u7167"),s(".")],-1),B=n("p",null,[n("strong",null,"P.S."),s(" \u8FD9\u610F\u5473\u7740\u4F60\u5BF9 config \u4E0A\u5B57\u6BB5\u7684\u66F4\u6539\u662F\u6CA1\u6709\u610F\u4E49\u7684.")],-1),M={id:"driver-extend-config-readonly",tabindex:"-1"},Y=n("code",null,"Driver::extend_config",-1),O=n("a",{class:"header-anchor",href:"#driver-extend-config-readonly","aria-hidden":"true"},"#",-1),U=o(`<p>\u5F53\u524D Driver \u7684\u6269\u5C55\u914D\u7F6E, \u6269\u5C55\u914D\u7F6E<strong>\u5E76\u975E</strong>\u53EF\u4EE5\u81EA\u7531\u5B9A\u4E49.</p><p>\u76EE\u524D, \u5728\u521B\u5EFA\u5B9E\u4F8B <code>new Driver(options)</code> \u65F6, \u4F1A\u8BFB\u53D6 <code>options.query[ext_conf_key]</code> \u6765\u83B7\u53D6\u4E00\u4E9B key-value \u4F5C\u4E3A\u6269\u5C55\u914D\u7F6E.</p><ul><li><code>pool</code>: \u662F\u5426\u4F7F\u7528\u8FDE\u63A5\u6C60, \u9ED8\u8BA4\u4E3A <code>false</code></li><li><code>debug</code>: \u662F\u5426\u4F7F\u7528 debug \u6A21\u5F0F. \u6839\u636E query value \u8FDB\u884C coerce, <code>&#39;0&#39; | &#39;false&#39; | &#39;no&#39; | &#39;n&#39; | &#39;&#39; </code>\u8868\u793A <code>false</code>, <code>&#39;1&#39; | &#39;true&#39; | &#39;y&#39;</code> \u6216\u5176\u5B83\u975E\u7A7A\u503C\u8868\u793A <code>true</code>.</li></ul><p>\u4E3E\u4F8B\u8BF4\u660E:</p><div class="language-js"><pre><code><span class="token comment">// those db.extend_config.pool // =&gt; true</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?pool=1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?pool=aaa&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?pool=true&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// those db.extend_config.debug // =&gt; true</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?debug=1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?debug=true&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// those db.extend_config.debug // =&gt; false</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?debug=0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?debug=no&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> Driver<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&#39;mysql://root:@localhost:3306/mydb?debug=false&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>`,5),F={id:"driver-connection-readonly",tabindex:"-1"},$=n("code",null,"Driver::connection",-1),X=n("a",{class:"header-anchor",href:"#driver-connection-readonly","aria-hidden":"true"},"#",-1),z=o("<p>\u5F53\u524D driver \u7684\u5B9E\u9645\u8FDE\u63A5\u5BF9\u8C61, \u53EF\u80FD\u662F\u4EE5\u4E0B\u7C7B\u578B:</p><table><thead><tr><th>\u9A71\u52A8\u7C7B\u578B</th><th>connection \u7C7B\u578B</th><th>\u662F\u5426\u4E3A fibjs \u539F\u751F\u5BF9\u8C61</th></tr></thead><tbody><tr><td><code>mysql</code></td><td><code>Class_MySQL</code></td><td>Y</td></tr><tr><td><code>sqlite</code></td><td><code>Class_SQLite</code></td><td>Y</td></tr><tr><td><code>postgresql</code></td><td><code>Class_DbConnection</code></td><td>Y</td></tr><tr><td><code>mongodb</code></td><td><code>Class_MongoDB</code></td><td>Y</td></tr><tr><td><code>redis</code></td><td><code>Class_Redis</code></td><td>Y</td></tr></tbody></table>",2),G={id:"driver-ispool-readonly",tabindex:"-1"},H=n("code",null,"Driver::isPool",-1),J=n("a",{class:"header-anchor",href:"#driver-ispool-readonly","aria-hidden":"true"},"#",-1),K=n("p",null,[s("\u5F53\u524D driver \u662F\u5426\u4F7F\u7528\u8FDE\u63A5\u6C60. \u5176\u503C\u53D6\u51B3\u4E8E "),n("code",null,"Driver.extend_config.pool"),s(" \u7684\u503C.")],-1),W={id:"driver-issql-readonly",tabindex:"-1"},Z=n("code",null,"Driver::isSql",-1),nn=n("a",{class:"header-anchor",href:"#driver-issql-readonly","aria-hidden":"true"},"#",-1),sn=n("p",null,[s("\u5F53\u524D driver \u662F\u5426\u5C5E\u4E8E SQL \u6570\u636E\u5E93\u7684\u5BA2\u6237\u7AEF, \u5982 "),n("code",null,"sqlite"),s(", "),n("code",null,"mysql"),s(", "),n("code",null,"postgresql"),s(".")],-1),en={id:"driver-isnosql-readonly",tabindex:"-1"},an=n("code",null,"Driver::isNoSql",-1),tn=n("a",{class:"header-anchor",href:"#driver-isnosql-readonly","aria-hidden":"true"},"#",-1),on=n("p",null,[s("\u5F53\u524D driver \u662F\u5426\u5C5E\u4E8E NoSQL \u6570\u636E\u5E93\u7684\u5BA2\u6237\u7AEF, \u5982 "),n("code",null,"mongodb"),s(".")],-1),rn={id:"driver-iscommand-readonly",tabindex:"-1"},cn=n("code",null,"Driver::isCommand",-1),pn=n("a",{class:"header-anchor",href:"#driver-iscommand-readonly","aria-hidden":"true"},"#",-1),dn=o('<p>\u5F53\u524D driver \u662F\u5426\u5C5E\u4E8E\u901A\u8FC7 command \u65B9\u5F0F\u548C server \u4EA4\u4E92\u7684\u5BA2\u6237\u7AEF, \u5982 <code>mongodb</code>, <code>redis</code>.</p><h3 id="driver-open-void" tabindex="-1"><code>Driver::open(): void</code> <a class="header-anchor" href="#driver-open-void" aria-hidden="true">#</a></h3><p>\u6253\u5F00\u5F53\u524D driver \u7684\u8FDE\u63A5, \u6253\u5F00\u540E, \u53EF\u4EE5\u548C\u6570\u636E\u5E93\u8FDB\u884C\u4EA4\u4E92. \u8BE5\u65B9\u6CD5\u5185\u90E8\u4F9D\u8D56 <code>Driver::getConnection</code> \u6765\u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61.</p><h3 id="driver-close-void" tabindex="-1"><code>Driver::close(): void</code> <a class="header-anchor" href="#driver-close-void" aria-hidden="true">#</a></h3><p>\u5173\u95ED\u5F53\u524D driver \u7684\u8FDE\u63A5, \u5173\u95ED\u540E, \u4E0D\u53EF\u4EE5\u548C\u6570\u636E\u5E93\u8FDB\u884C\u4EA4\u4E92.</p><h3 id="driver-reopen-void" tabindex="-1"><code>Driver::reopen(): void</code> <a class="header-anchor" href="#driver-reopen-void" aria-hidden="true">#</a></h3><p><strong>\u5B89\u5168\u5730</strong>\u5173\u95ED\u5F53\u524D driver \u7684\u8FDE\u63A5, \u540E\u5E76\u91CD\u65B0\u6253\u5F00\u8FDE\u63A5.</p><p>\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u5728 driver \u672A\u5F00\u542F\u65F6\u8C03\u7528</p><h3 id="driver-getconnection-t" tabindex="-1"><code>Driver::getConnection(): T</code> <a class="header-anchor" href="#driver-getconnection-t" aria-hidden="true">#</a></h3><p>\u83B7\u53D6\u4E00\u4E2A driver \u9A71\u52A8\u7C7B\u578B\u7684\u8FDE\u63A5\u5BF9\u8C61,</p><p><strong>\u6CE8\u610F</strong> \u8BE5\u65B9\u6CD5\u7684\u542B\u4E49\u5E76\u4E0D\u662F\u300C\u8FD4\u56DE driver \u7684 connection \u5BF9\u8C61\u300D, \u76F8\u5BF9\u5730, \u8BE5\u65B9\u6CD5\u88AB\u8C03\u7528\u5F80\u5F80\u662F\u4E3A\u4E86\u7ED9 connection \u5BF9\u8C61\u8D4B\u503C.</p><h3 id="driver-connectionpool-callback-connection-conn-type-any-any" tabindex="-1"><code>Driver::connectionPool(callback: (connection: CONN_TYPE) =&gt; any): any</code> <a class="header-anchor" href="#driver-connectionpool-callback-connection-conn-type-any-any" aria-hidden="true">#</a></h3><p>\u5F53 <code>this.isPool</code> \u4E3A\u771F, \u4F1A\u4ECE\u8FDE\u63A5\u6C60\u4E2D\u83B7\u53D6\u4E00\u4E2A <code>connection</code> \u5BF9\u8C61, \u4F5C\u4E3A\u4F20\u8F93\u4F20\u5165 <code>callback</code> \u56DE\u8C03\u6267\u884C;</p><p>\u5426\u5219, \u5219\u4F1A\u8C03\u7528 <code>this.getConnection()</code> \u83B7\u53D6\u4E00\u4E2A <code>connection</code> \u5BF9\u8C61, \u4F5C\u4E3A\u4F20\u8F93\u4F20\u5165 <code>callback</code> \u56DE\u8C03\u6267\u884C.</p><h3 id="driver-usetrans-callback-conn-for-trans-conn-type-any" tabindex="-1"><code>Driver::useTrans(callback: (conn_for_trans: CONN_TYPE) =&gt; any)</code> <a class="header-anchor" href="#driver-usetrans-callback-conn-for-trans-conn-type-any" aria-hidden="true">#</a></h3><p>\u83B7\u53D6\u4E00\u4E2A\u8FDE\u63A5 <code>conn_for_trans</code>, \u4EE5\u4E8B\u52A1\u7684\u65B9\u5F0F\u6267\u884C\u4E00\u4E2A <code>callback</code>.</p><h2 id="sqldriver" tabindex="-1"><code>SQLDriver</code> <a class="header-anchor" href="#sqldriver" aria-hidden="true">#</a></h2><p><strong>\u6D3E\u751F\u5173\u7CFB</strong> <code>class SQLDriver extends Driver</code></p><p><code>SQLDriver</code> \u662F\u9488\u5BF9 SQL \u6570\u636E\u5E93\u7684 Driver:</p><p>db-driver \u652F\u6301\u4EE5\u4E0B SQL \u6570\u636E\u5E93:</p><ul><li><code>MySQLDriver</code>: <code>extends SQLDriver</code></li><li><code>PostgreSQLDriver</code>: <code>extends SQLDriver</code></li><li><code>SQLiteDriver</code>: <code>extends SQLDriver</code></li></ul><p>\u6839\u636E\u5173\u7CFB\u578B\u6570\u636E\u5E93\u7684\u7279\u70B9, <code>SQLDriver</code> \u5728 <code>Driver</code> \u7684\u57FA\u7840\u4E0A\u6269\u5C55\u4E86\u63A5\u53E3\u5B9A\u4E49. \u5E76\u7531\u5176\u6D3E\u751F\u7684\u5B50\u7C7B\u5B9E\u73B0\u5177\u4F53\u7684\u63A5\u53E3.</p><h3 id="sqldriver-switchdb-db-name" tabindex="-1"><code>SQLDriver::switchDb(db: name)</code> <a class="header-anchor" href="#sqldriver-switchdb-db-name" aria-hidden="true">#</a></h3><p>\u5207\u6362\u5F53\u524D\u8FDE\u63A5\u7684\u6570\u636E\u5E93. \u5BF9\u4E8E\u90E8\u5206 SQL \u6570\u636E\u5E93\u800C\u8A00\u8BE5\u65B9\u6CD5\u6CA1\u6709\u610F\u4E49, \u6BD4\u5982 SQLite \u8FDE\u63A5\u540E\u5FC5\u7136\u662F\u5355\u5E93\u6A21\u5F0F.</p><h3 id="sqldriver-trans-cb-function-boolean" tabindex="-1"><code>SQLDriver::trans(cb: Function): boolean</code> <a class="header-anchor" href="#sqldriver-trans-cb-function-boolean" aria-hidden="true">#</a></h3><p>SQL \u6570\u636E\u5E93\u4E00\u822C\u90FD\u652F\u6301\u4E8B\u52A1(Transaction),</p><p>\u4F60\u4E5F\u53EF\u4EE5\u4F7F\u7528\u72EC\u7ACB\u7684\u4E8B\u52A1\u63A5\u53E3, \u624B\u52A8\u63A7\u5236\u4E8B\u52A1.</p><ul><li><code>SQLDriver::begin()</code></li><li><code>SQLDriver::commit()</code></li><li><code>SQLDriver::rollback()</code></li></ul>',28),ln={id:"sqldriver-execute-sql-string-blocking",tabindex:"-1"},un=n("code",null,"SQLDriver::execute(sql: string)",-1),vn=n("a",{class:"header-anchor",href:"#sqldriver-execute-sql-string-blocking","aria-hidden":"true"},"#",-1),kn=o('<p>\u6267\u884C sql \u8BED\u53E5, \u5E76\u8FD4\u56DE\u6267\u884C\u7ED3\u679C.</p><p><strong>\u6CE8\u610F</strong> \u8BE5\u65B9\u6CD5\u4E3A\u963B\u585E\u65B9\u6CD5, \u4EC5\u652F\u6301\u552F\u4E00\u7684\u53C2\u6570 <code>sql</code>, \u56E0\u6B64\u5BF9 sql \u8BED\u53E5\u7684 escape \u5FC5\u987B\u7531\u8C03\u7528\u8005\u81EA\u884C\u5B8C\u6210.</p><h2 id="redisdriver" tabindex="-1"><code>RedisDriver</code> <a class="header-anchor" href="#redisdriver" aria-hidden="true">#</a></h2><p><strong>\u6D3E\u751F\u5173\u7CFB</strong> <code>class RedisDriver extends Driver</code></p>',4),_n={id:"redisdriver-command-cmd-string-arg-any-blocking",tabindex:"-1"},hn=n("code",null,"RedisDriver::command(cmd: string, arg: any)",-1),gn=n("a",{class:"header-anchor",href:"#redisdriver-command-cmd-string-arg-any-blocking","aria-hidden":"true"},"#",-1),mn=n("p",null,"\u6267\u884C\u4E00\u4E2A redis cmd(cmd \u53C2\u6570\u4E3A arg), \u5E76\u8FD4\u56DE\u6267\u884C\u7ED3\u679C.",-1),bn={id:"redisdriver-commands-cmds-record-string-any-opts-object-blocking",tabindex:"-1"},yn=n("code",null,"RedisDriver::commands(cmds: Record<string, any>, opts: object)",-1),Dn=n("a",{class:"header-anchor",href:"#redisdriver-commands-cmds-record-string-any-opts-object-blocking","aria-hidden":"true"},"#",-1),fn=o(`<p>\u6267\u884C\u4E00\u7EC4 redis cmds, \u5E76\u8FD4\u56DE\u6267\u884C\u7ED3\u679C.</p><p>cmds \u7ED3\u6784:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">IRedisCmds</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>cmd<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token comment">/* arg */</span><span class="token builtin">any</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="mongodriver" tabindex="-1"><code>MongoDriver</code> <a class="header-anchor" href="#mongodriver" aria-hidden="true">#</a></h2><p><strong>\u6D3E\u751F\u5173\u7CFB</strong> <code>class MongoDriver extends Driver</code></p>`,5),qn={id:"mongodriver-command-cmd-string-arg-any-blocking",tabindex:"-1"},Sn=n("code",null,"MongoDriver::command(cmd: string, arg: any)",-1),Tn=n("a",{class:"header-anchor",href:"#mongodriver-command-cmd-string-arg-any-blocking","aria-hidden":"true"},"#",-1),xn=n("p",null,"\u6267\u884C\u4E00\u4E2A mongodb cmd(cmd \u53C2\u6570\u4E3A arg), \u5E76\u8FD4\u56DE\u6267\u884C\u7ED3\u679C.",-1),wn={id:"mongodriver-commands-cmds-object-opts-object-blocking",tabindex:"-1"},jn=n("code",null,"MongoDriver::commands(cmds: object, opts: object)",-1),Cn=n("a",{class:"header-anchor",href:"#mongodriver-commands-cmds-object-opts-object-blocking","aria-hidden":"true"},"#",-1),An=o(`<p>\u6267\u884C\u4E00\u7EC4 mongodb cmds, \u5E76\u8FD4\u56DE\u6267\u884C\u7ED3\u679C.</p><p>cmds \u7ED3\u6784:</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">IMongoDBCmds</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>cmd<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token comment">/* arg */</span><span class="token builtin">any</span>
<span class="token punctuation">}</span>
</code></pre></div>`,3);function Ln(Pn,Qn,En,Nn,In,Rn){const e=c("Badge");return i(),p("div",null,[l,n("h3",u,[v,s(),a(e,{type:"info"},{default:t(()=>[s("static")]),_:1}),s(),k]),_,n("h3",h,[g,s(),a(e,{type:"info"},{default:t(()=>[s("static")]),_:1}),s(),m]),b,n("h3",y,[D,s(),a(e,{type:"info"},{default:t(()=>[s("static")]),_:1}),s(),f]),q,n("h3",S,[T,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),x]),w,n("h3",j,[C,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),A]),L,P,Q,E,n("h3",N,[I,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),R]),V,B,n("h3",M,[Y,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),O]),U,n("h3",F,[$,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),X]),z,n("h3",G,[H,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),J]),K,n("h3",W,[Z,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),nn]),sn,n("h3",en,[an,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),tn]),on,n("h3",rn,[cn,s(),a(e,{type:"warning"},{default:t(()=>[s("readonly")]),_:1}),s(),pn]),dn,n("h3",ln,[un,s(),a(e,{type:"warning"},{default:t(()=>[s("blocking")]),_:1}),s(),vn]),kn,n("h3",_n,[hn,s(),a(e,{type:"warning"},{default:t(()=>[s("blocking")]),_:1}),s(),gn]),mn,n("h3",bn,[yn,s(),a(e,{type:"warning"},{default:t(()=>[s("blocking")]),_:1}),s(),Dn]),fn,n("h3",qn,[Sn,s(),a(e,{type:"warning"},{default:t(()=>[s("blocking")]),_:1}),s(),Tn]),xn,n("h3",wn,[jn,s(),a(e,{type:"warning"},{default:t(()=>[s("blocking")]),_:1}),s(),Cn]),An])}var Mn=r(d,[["render",Ln]]);export{Bn as __pageData,Mn as default};

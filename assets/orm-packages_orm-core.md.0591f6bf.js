import{_ as n,y as a,x as s,X as o}from"./plugin-vue_export-helper.bb29c578.js";const h='{"title":"@fxjs/orm-core","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u9519\u8BEF\u5904\u7406","slug":"\u9519\u8BEF\u5904\u7406"},{"level":3,"title":"catchBlocking","slug":"catchblocking"},{"level":3,"title":"takeAwayResult","slug":"takeawayresult"}],"relativePath":"orm-packages/orm-core.md","lastUpdated":1673103759120}',t={},e=o(`<h1 id="fxjs-orm-core" tabindex="-1"><code>@fxjs/orm-core</code> <a class="header-anchor" href="#fxjs-orm-core" aria-hidden="true">#</a></h1><p><a href="https://www.npmjs.org/package/@fxjs/orm-core" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/v/@fxjs/orm-core.svg" alt="NPM version"></a>\xA0 <a href="https://www.npmjs.org/package/@fxjs/orm-core" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/dt/@fxjs/orm-core.svg" alt="NPM download"></a>\xA0 <a href="https://www.npmjs.org/package/@fxjs/orm-core" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/npm/dm/@fxjs/orm-core.svg" alt="NPM download monthly"></a></p><h2 id="\u9519\u8BEF\u5904\u7406" tabindex="-1">\u9519\u8BEF\u5904\u7406 <a class="header-anchor" href="#\u9519\u8BEF\u5904\u7406" aria-hidden="true">#</a></h2><p>orm core \u63D0\u4F9B\u4E86\u4E00\u4E9B\u7528\u4E8E\u5904\u7406 fibjs \u4E2D blocking/non-blocking API \u4E0B\u9519\u8BEF\u7684 utils</p><ul><li><code>catchBlocking</code> / <code>Utils.exposeErrAndResultFromSyncMethod</code></li><li><code>takeAwayResult</code> / <code>Utils.throwErrOrCallabckErrResult</code></li></ul><p>\u5176\u4F7F\u7528\u573A\u666F\u53EF\u4EE5\u53C2\u8003\u5176<a href="https://github.com/fxjs-modules/orm/blob/00116a2b9a6c32269a6980ffd19a878d1bc36080/packages/core/test/integration/utils.js" target="_blank" rel="noopener noreferrer">\u6D4B\u8BD5\u7528\u4F8B</a>,</p><p>\u5728 orm \u4E2D, blocking \u6216 non-blocking \u98CE\u683C\u6267\u884C\u51FD\u6570\u90FD\u53EF\u80FD\u5B58\u5728\u9519\u8BEF:</p><div class="language-js"><pre><code><span class="token comment">// blocking-style</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> orm<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// non-blocking-style</span>
orm<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>\u5173\u4E8E block/non-blocking \u5BF9 error \u7684\u5904\u7406\u65B9\u5F0F, \u53C2\u8003<a href="./../orm/getting-started.html#\u540C\u6B65\u963B\u585E-vs-\u5F02\u6B65\u975E\u963B\u585E">\u540C\u6B65\u963B\u585E vs \u5F02\u6B65\u975E\u963B\u585E</a></p><p>\u65E0\u8BBA\u54EA\u79CD\u98CE\u683C, \u90FD\u6D89\u53CA\u5230\u4E24\u4E2A\u5BF9\u8C61 <code>error</code> \u548C <code>result</code>, \u53EF\u4EE5\u603B\u7ED3\u4E3A <code>ExposedResult</code> \u7ED3\u6784</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">ExposedResult<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    error<span class="token operator">:</span> FxOrmCoreError<span class="token punctuation">.</span>ExtendedError<span class="token punctuation">,</span>
    result<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="catchblocking" tabindex="-1">catchBlocking <a class="header-anchor" href="#catchblocking" aria-hidden="true">#</a></h3><p>\u6267\u884C\u4E00\u4E2A <code>execution</code> \u8FC7\u7A0B, \u5E76 catch \u5176\u4E2D\u53EF\u80FD\u629B\u51FA\u7684\u9519\u8BEF</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">catchBlocking</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span>
	execution<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">,</span>
	args<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	opts<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		thisArg<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token operator">:</span> FxOrmCoreSyncNS<span class="token punctuation">.</span>ExposedResult<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="takeawayresult" tabindex="-1">takeAwayResult <a class="header-anchor" href="#takeawayresult" aria-hidden="true">#</a></h3><p>\u5982\u679C <code>opts.callback</code> \u662F\u65B9\u6CD5, \u4F7F\u7528 <code>opts.callback</code> \u56DE\u8C03\u5904\u7406 <code>input: ExposedResult</code> \u5BF9\u8C61, \u4E14\u4E0D\u629B\u51FA\u9519\u8BEF; \u5426\u5219, \u5F53 <code>input.error</code> \u975E\u7A7A\u65F6\u5C06\u5176\u629B\u51FA.</p><div class="language-ts"><pre><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">takeAwayResult</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">RESULT_T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>input<span class="token operator">:</span> FxOrmCoreSyncNS<span class="token punctuation">.</span>ExposedResult<span class="token operator">&lt;</span><span class="token constant">RESULT_T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> opts<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    callback<span class="token operator">?</span><span class="token operator">:</span> FxOrmCoreCallbackNS<span class="token punctuation">.</span>ExecutionCallback<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token constant">RESULT_T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    no_throw<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    use_tick<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre></div><p>\u8BE5\u65B9\u6CD5\u5E38\u5E38\u7528\u4E8E\u5E2E\u52A9\u5B9E\u73B0\u672C\u8D28\u4E0A\u5305\u542B\u5F02\u6B65\u64CD\u4F5C, \u4E14\u5728\u540C\u65F6\u5177\u6709 blocking / non-blocking \u98CE\u683C\u7684\u51FD\u6570. \u5728\u51FD\u6570\u5185\u90E8, \u82E5 <code>input.error</code> \u4E0D\u4E3A\u7A7A, <code>takeAwayResult</code> \u4F1A\u6839\u636E <code>callback</code> \u662F\u5426\u4E3A\u65B9\u6CD5\u505A\u51FA\u4E0D\u540C\u7684\u5904\u7406:</p><ol><li>\u5982\u679C <code>callback</code> \u662F\u4E00\u4E2A\u65B9\u6CD5, \u5219<strong>\u4E0D</strong> throw <code>input.error</code>, \u800C\u662F\u4EA4\u7531 <code>callback</code> \u56DE\u8C03</li><li>\u5426\u5219, \u5219\u76F4\u63A5 throw <code>input.error</code></li></ol><p>\u5F00\u53D1\u8005\u4E5F\u53EF\u4EE5\u901A\u8FC7\u624B\u52A8\u6307\u5B9A <code>no_throw</code> \u7684\u503C, \u6765\u5F3A\u5236\u662F\u5426 throw <code>input.error</code>.</p>`,20),p=[e];function c(r,l,i,k,u,d){return s(),a("div",null,p)}var m=n(t,[["render",c]]);export{h as __pageData,m as default};
